# ============================================================================
# Trading Alerts SaaS V7 - Aider Configuration
# ============================================================================
# This file configures Aider to work autonomously with MiniMax M2 API
# following our 6 policy documents for consistent, high-quality code generation.
#
# Last Updated: 2025-11-11
# ============================================================================

# ============================================================================
# MODEL CONFIGURATION
# ============================================================================
# MiniMax M2 is configured as the default model
# ~80% cheaper than GPT-4 while maintaining quality

# Main model for code generation (MiniMax M2)
model: anthropic/MiniMax-M2

# Editor model for smaller edits
editor-model: anthropic/MiniMax-M2

# Weak model for simple tasks (summaries, commit messages)
weak-model: anthropic/MiniMax-M2

# Note: Set ANTHROPIC_API_KEY in your environment:
# set ANTHROPIC_API_KEY=your_minimax_api_key
# If using a custom Anthropic-compatible endpoint, also set:
# set ANTHROPIC_API_BASE=https://your-custom-endpoint.com/v1

# ============================================================================
# ENVIRONMENT FILE
# ============================================================================
# Load API keys from .env file automatically
env-file: .env

# ============================================================================
# AUTO-COMMIT SETTINGS
# ============================================================================

# Enable auto-commits after successful code generation
# Set to false for interactive testing, true for autonomous mode
auto-commits: false

# Commit message template
# Aider will use this format for commit messages
# commit-prompt: |
#   Write a concise commit message following conventional commits format.
#   Format: <type>(<scope>): <description>
#   Types: feat, fix, docs, style, refactor, test, chore
#   Include validation results in commit body.

# Require attribution in commits
attribute-author: true
attribute-committer: true

# ============================================================================
# POLICY DOCUMENTS (READ-ONLY)
# ============================================================================
# These files guide Aider's decision-making but should never be modified

read:
  # Core policy documents (PRIMARY GUIDANCE)
  - docs/policies/01-approval-policies.md
  - docs/policies/02-quality-standards.md
  - docs/policies/03-architecture-rules.md
  - docs/policies/04-escalation-triggers.md
  - docs/policies/05-coding-patterns.md
  - docs/policies/06-aider-instructions.md

  # Architecture and structure documentation
  - ARCHITECTURE.md
  - DOCKER.md
  - docs/v5-structure-division.md
  - phase_milestones_v7_minimax.md

  # Tier specifications
  - docs/policies/00-tier-specifications.md

  # OpenAPI specifications (source of truth)
  - trading_alerts_openapi.yaml
  - docs/flask_mt5_openapi.yaml

  # Seed code examples (reference only)
  - seed-code/market_ai_engine.py

  # Project overview
  - README.md
  - package.json  # Dependencies available for code generation

  # Progress tracking (Aider updates this, but reads for context)
  - PROGRESS.md

  # ============================================================================
  # SEED CODE (REFERENCE ONLY - READ-ONLY)
  # ============================================================================
  # V0.dev component references for UI frontend development (20 total components)
  # These serve as visual references and coding patterns for production components
  # Complete documentation: seed-code/v0-components/README.md & docs/ui-components-map.md
  # Organized by category: public-pages, auth, dashboard, components, layouts, charts, alerts

  # V0 Components - Main README (complete 20-component mapping guide)
  - seed-code/v0-components/README.md

  # V0 Components - PUBLIC PAGES (Marketing & Registration - 3 components)
  # When generated from v0.dev, uncomment these files:
  # - seed-code/v0-components/public-pages/homepage.tsx              # → app/(marketing)/page.tsx
  # - seed-code/v0-components/public-pages/pricing-page.tsx          # → app/(marketing)/pricing/page.tsx
  # - seed-code/v0-components/public-pages/registration-page.tsx     # → app/(auth)/register/page.tsx

  # V0 Components - AUTH (Authentication pages - 2 components)
  # When generated from v0.dev, uncomment these files:
  # - seed-code/v0-components/auth/login-page.tsx                    # → app/(auth)/login/page.tsx
  # - seed-code/v0-components/auth/forgot-password-page.tsx          # → app/(auth)/forgot-password/page.tsx

  # V0 Components - DASHBOARD (Main app pages - 8 components)
  # When generated from v0.dev, uncomment these files:
  # - seed-code/v0-components/dashboard/dashboard-overview.tsx       # → app/(dashboard)/dashboard/page.tsx
  # - seed-code/v0-components/dashboard/watchlist-page.tsx           # → app/(dashboard)/watchlist/page.tsx
  # - seed-code/v0-components/dashboard/alert-creation-modal.tsx     # → components/alerts/alert-modal.tsx
  # - seed-code/v0-components/dashboard/alerts-list.tsx              # → app/(dashboard)/alerts/page.tsx
  # - seed-code/v0-components/dashboard/billing-page.tsx             # → app/(dashboard)/settings/billing/page.tsx
  # - seed-code/v0-components/dashboard/settings-layout.tsx          # → app/(dashboard)/settings/layout.tsx
  # - seed-code/v0-components/dashboard/profile-settings.tsx         # → app/(dashboard)/settings/profile/page.tsx

  # V0 Components - COMPONENTS (Reusable UI - 4 components)
  # When generated from v0.dev, uncomment these files:
  # - seed-code/v0-components/components/chart-controls.tsx          # → components/charts/chart-controls.tsx
  # - seed-code/v0-components/components/empty-states.tsx            # → components/ui/empty-state.tsx
  # - seed-code/v0-components/components/notification-bell.tsx       # → components/layout/notification-bell.tsx
  # - seed-code/v0-components/components/user-menu.tsx               # → components/layout/user-menu.tsx
  # - seed-code/v0-components/components/footer.tsx                  # → components/layout/footer.tsx

  # V0 Components - EXISTING SEED (Reference implementations - 3 components)
  # Layouts (Dashboard shell, sidebar, navigation)
  - seed-code/v0-components/layouts/dashboard-layout.tsx
  - seed-code/v0-components/layouts/dashboard-page.tsx
  - seed-code/v0-components/layouts/dashboard-globals.css

  # Charts (TradingView integration examples)
  - seed-code/v0-components/charts/trading-chart.tsx
  - seed-code/v0-components/charts/trading-chart-page.tsx

  # Alerts (Alert card and management)
  - seed-code/v0-components/alerts/alert-card.tsx
  - seed-code/v0-components/alerts/alert-card-page.tsx

  # Note: Package.json files in seed-code are for reference only
  # Dependencies should be added to main package.json after review
  # When you generate the 17 new components from v0.dev, uncomment the relevant lines above

# ============================================================================
# GIT CONFIGURATION
# ============================================================================

# Use git for version control
git: true

# Automatically add new files to git
gitignore: true

# Show git diffs before committing
show-diffs: true

# ============================================================================
# EDITING BEHAVIOR
# ============================================================================

# Editing format (whole file, diff, or udiff)
# "diff" is more efficient for large files
edit-format: diff

# Enable code streaming (faster feedback)
stream: true

# Show repository map for context
map-tokens: 2048

# Use universal ctags for better code navigation
# Disabled: may cause issues if ctags not installed
# use-ctags: false  # Not supported in config file for this version

# ============================================================================
# VALIDATION & TESTING
# ============================================================================

# Run linting checks
# Disabled: may cause issues if linter not configured
lint: false

# Run tests after changes (if available)
# test-cmd: npm test

# Lint command (if you want Aider to auto-lint)
# lint-cmd: npm run lint

# ============================================================================
# CHAT SETTINGS
# ============================================================================

# Enable chat history
chat-history-file: .aider.chat.history.md

# Save input history
input-history-file: .aider.input.history

# Enable pretty output with colors
pretty: true

# Show token usage for cost tracking
show-model-warnings: true

# ============================================================================
# FILE HANDLING
# ============================================================================

# Note: auto-add and ignore are not supported in .aider.conf.yml for v0.86.1
# Use .aiderignore file instead for ignoring files
# Use command-line arguments to add specific files

# Automatically add commonly needed files
# auto-add:
#   - "*.ts"
#   - "*.tsx"
#   - "*.py"
#   - "*.yaml"
#   - "*.yml"
#   - "*.json"
#   - "*.md"

# Ignore patterns (in addition to .gitignore)
# ignore:
#   - node_modules/
#   - .next/
#   - dist/
#   - build/
#   - __pycache__/
#   - "*.pyc"
#   - .env
#   - .env.local

# ============================================================================
# ADVANCED SETTINGS
# ============================================================================

# Number of context messages to keep
max-chat-history: 100

# Enable suggestions from Aider
suggest-shell-commands: true

# Enable voice input (if supported)
# voice: false

# Dark mode for terminal output
dark-mode: true

# ============================================================================
# ENVIRONMENT VARIABLES (Set these in your shell, NOT here!)
# ============================================================================
# Required for MiniMax M2:
#   ANTHROPIC_API_KEY=your_minimax_api_key_here
#
# MiniMax M2 uses Anthropic-compatible API, so set ANTHROPIC_API_KEY.
# If using a custom endpoint (not standard Anthropic API), also set:
#   ANTHROPIC_API_BASE=https://your-custom-endpoint.com/v1
#
# Optional (for the app itself):
#   DATABASE_URL=postgresql://...
#   NEXT_PUBLIC_API_URL=http://localhost:3000
#
# Never commit API keys! Keep them in .env (which is gitignored)
# ============================================================================

# ============================================================================
# USAGE INSTRUCTIONS
# ============================================================================
#
# Basic Commands:
# ---------------
# Start Aider:
#   aider
#
# Add files to chat:
#   /add app/api/example/route.ts
#   /add components/example.tsx
#
# Read policy files (already auto-loaded from 'read' section above):
#   Policies are automatically available as context
#
# Ask Aider to implement:
#   "Implement GET /api/alerts following Pattern 1 from 05-coding-patterns.md"
#   "Create the tier validation utility from 03-architecture-rules.md"
#
# Check validation:
#   "Validate the code with Claude Code and show results"
#
# Commit:
#   /commit
#   (or auto-commits if auto-commits: true)
#
# See help:
#   /help
#
# Exit:
#   /exit
#
# ============================================================================
# WORKFLOW EXAMPLE (from 06-aider-instructions.md)
# ============================================================================
#
# 1. Start Aider:
#    $ aider
#
# 2. Aider loads policy files automatically (from 'read' section)
#
# 3. Tell Aider what to build:
#    You: "Implement Part 1: Foundation & Root Configuration"
#
# 4. Aider follows 7-step workflow:
#    - Read Requirements (policies, OpenAPI, seed code)
#    - Plan Implementation
#    - Generate Code
#    - Validate with Claude Code
#    - Decide (approve/fix/escalate)
#    - Act (commit or fix)
#    - Update PROGRESS.md
#
# 5. Aider reports progress every 3 files
#
# 6. If escalation needed, Aider asks you for decision
#
# ============================================================================
# TROUBLESHOOTING
# ============================================================================
#
# Issue: "Model not found"
# Fix: Ensure ANTHROPIC_API_KEY is set and model name is correct
#
# Issue: "Policy files not loading"
# Fix: Check that 'read' paths are correct (relative to project root)
#
# Issue: "Auto-commits not working"
# Fix: Ensure git is initialized and auto-commits: true
#
# Issue: "Aider too slow"
# Fix: Reduce map-tokens or use lighter weak-model
#
# Issue: "Validation failing"
# Fix: Ensure Claude Code is available and ANTHROPIC_API_KEY is set
#
# ============================================================================
